Apache Kafka 与 Golang：入门

在此之前，我对消息队列服务用的比较多是 RabbitMQ，仅使用它将其为生产者/洗消费者服务的必要中间件。使用消息队列的场景基本是为了降低系统的耦合度，业务之间增加消息队列，还有

就是对于一些场景是因为处理时间过长影响整个业务，且允许数据最终一致性的前提下，使用消息队列进行异步处理。

Kafka 是个开源分布式事件流平台，被很多公司用于高性能数据管道、流分析、数据集成应用程序。使用它的原因主要因其有很多优势：

- 提高可靠性：队列可以让数据持久化，如果你的一部分服务无法访问时，另一部分可以继续和队列交互

- 更好的性能：支持异步通信，生产者和消费者的端点都与消息队列交互，而不是生产者和消费者相交互

- 可扩展性：当系统在高峰时，消息队列可以协助我们需要的场景上进行扩展

通过 REST API 添加消息然后在 Apache 中生成并在消费者/工作者中处理它是一个简单的系统。 它可以是任何耗时的过程，例如保存数据存储并执行聚合或一些计算。

在本地运行 Kafka
这篇文章中的所有示例都是在我的机器上本地运行的经过测试的 Kafka。 您也可以使用 Docker 和 docker-compose 来实现。

使用 REST API 编写生产者
我正在使用 Sarama，它是 Apache Kafka 的 Go 库。 还有其他选择，例如 kafka-go。 一个原因是 sarama 比 kakfa-go 更快，另一个原因是围绕 sarama 去社区，它的代码有助于选择 sarama。

使用 sarama 作为 Producer 连接到 Apache Kafka

使用 sarama 将评论推送到队列（主题）
这个函数非常简单，它将主题和消息作为参数，使用上面的函数 ConnectProducer 连接到 kafka 并将该消息推送到给定主题。

https://medium.com/swlh/apache-kafka-with-golang-227f9f2eb818
